var A=Object.defineProperty;var u=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var c=(n,s,o)=>s in n?A(n,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[s]=o,h=(n,s)=>{for(var o in s||(s={}))m.call(s,o)&&c(n,o,s[o]);if(u)for(var o of u(s))b.call(s,o)&&c(n,o,s[o]);return n};(function(n,s){typeof exports=="object"&&typeof module!="undefined"?module.exports=s():typeof define=="function"&&define.amd?define(s):(n=typeof globalThis!="undefined"?globalThis:n||self,n.JsonapiNormalizer=s())})(this,function(){"use strict";class n{static deserialize(t){let{data:i,included:e,meta:r,links:a}=t,p={},d=e&&e.length>0?y(e):null;return Array.isArray(i)?p=i.map(_=>s(_,d)):p=s(i,d),{data:p,meta:r,links:a}}}function s(l,t){let i=h({id:l.id},l.attributes);if(l.relationships&&t){let e=Object.keys(l.relationships).map(a=>({property:a,data:l.relationships[a].data})).filter(a=>!Array.isArray(a.data)||a.data.length>0),r=o(t,e);Object.keys(r).forEach(a=>{i[a]=r[a]})}return i}function o(l,t){let i={};return Object.keys(t).forEach(e=>{if(Array.isArray(t[e].data))i[t[e].property]=[],t[e].data.forEach(r=>{let a=r.type+"_"+r.id;i[t[e].property].push(l[a]),f(a,l)});else{let r=t[e].data.type+"_"+t[e].data.id;i[t[e].property]=l[r],f(r,l)}}),i}function f(l,t){let i=t[l];i._relationships&&(Object.keys(i._relationships).forEach(e=>{if(Array.isArray(i._relationships[e]))i[e]=[],i._relationships[e].forEach(r=>{i[e].push(t[r])});else{let r=i._relationships[e];i[e]=t[r]}}),delete i._relationships)}function y(l){let t={};for(let i=0;i<l.length;i++){let e=l[i],r=e.type+"_"+e.id;t[r]=h({id:e.id},e.attributes),e.relationships&&Object.keys(e.relationships).forEach(a=>{let p=e.relationships[a].data;t[r]._relationships=t[r]._relationships||{},Array.isArray(p)?(t[r]._relationships[a]=[],p.forEach(d=>{t[r]._relationships[a].push(d.type+"_"+d.id)})):t[r]._relationships[a]=p.type+"_"+p.id})}return t}return n});
